(()=>{const t=document.querySelector("[data-lists]"),e=document.querySelector("[data-new-list-form"),a=document.querySelector("[data-new-list-input]"),n=document.querySelector("[data-delete-list-button]"),l=document.querySelector("[data-list-display-container]"),s=document.querySelector("[data-list-title]"),d=document.querySelector("[data-list-count]"),i=document.querySelector("[data-tasks]"),o=document.getElementById("task-template"),c=document.querySelector("[data-new-task-form]"),r=document.querySelector("[data-new-task-input]"),u=document.querySelector("[data-clear-complete-tasks-button]"),m="task.lists",p="task.selectedListId";let k=JSON.parse(localStorage.getItem(m))||[],f=localStorage.getItem(p);t.addEventListener("click",(t=>{"li"===t.target.tagName.toLowerCase()&&(f=t.target.dataset.listId,g())})),u.addEventListener("click",(t=>{const e=k.find((t=>t.id===f));e.tasks=e.tasks.filter((t=>!t.complete)),g()})),n.addEventListener("click",(t=>{k=k.filter((t=>t.id!==f)),f=null,g()})),i.addEventListener("click",(t=>{if("input"===t.target.tagName.toLowerCase()){const e=k.find((t=>t.id===f));e.tasks.find((e=>e.id===t.target.id)).complete=t.target.checked,v(),L(e)}})),e.addEventListener("submit",(t=>{t.preventDefault();const e=a.value;if(null==e||""===e)return;const n=S(e);a.value=null,k.push(n),g()})),c.addEventListener("submit",(t=>{t.preventDefault();const e=r.value;if(null==e||""===e)return;const a=y(e);r.value=null,k.find((t=>t.id===f)).tasks.push(a),g()}));const S=t=>({id:Date.now().toString(),name:t,tasks:[]}),y=t=>({id:Date.now().toString(),name:t,complete:!1}),g=()=>{v(),h()},v=()=>{localStorage.setItem(m,JSON.stringify(k)),localStorage.setItem(p,f)},h=()=>{w(t),E();const e=k.find((t=>t.id===f));null==f?l.style.display="none":(l.style.display="",s.innerHTML=e.name,L(e),w(i),q(e))},q=t=>{t.tasks.forEach((t=>{const e=document.importNode(o.content,!0),a=e.querySelector("input");a.id=t.id,a.checked=t.complete;const n=e.querySelector("label");n.htmlFor=t.id,n.append(t.name),i.appendChild(e)}))},L=t=>{const e=t.tasks.filter((t=>!t.complete)).length,a=1===e?"task":"tasks";d.innerText=`${e} ${a} remaining`},E=()=>{k.forEach((e=>{const a=document.createElement("li");a.dataset.listId=e.id,a.classList.add("list-name"),a.innerText=e.name,e.id===f&&a.classList.add("active-list"),t.appendChild(a)}))},w=t=>{for(;t.firstChild;)t.removeChild(t.firstChild)};h()})();